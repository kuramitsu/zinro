<!DOCTYPE html>
<html lang="ja" ng-app="zinroApp">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">
    <title>人狼</title>
    <link rel="stylesheet" href="<%= @static_url %>/bootstrap-3.3.6-dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="<%= @static_url %>/bootstrap-3.3.6-dist/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="<%= @static_url %>/zinro/css/main.css">
    <!--<script src="<%= @static_url %>/angular/angular.min.js"></script>-->
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>
    <script src="<%= @static_url %>/angular-strap/dist/angular-strap.min.js"></script>
    <script src="<%= @static_url %>/angular-strap/dist/angular-strap.tpl.min.js"></script>
    <script>
        var homeurl = "http://<%= @host %>";
    </script>
    <script src="<%= @static_url %>/zinro/js/main.js"></script>
</head>
<body ng-controller="ZinroCtrl">
    <nav id="navheader" class="navbar navbar-fixed-top navbar-inverse" role="navigation" bs-navbar>
        <div class="container">
            <!-- http://rails.honobono-life.info/Tutorial_Bootstrap3_AngularJS_NavMenu  -->
            <div class="navbar-header" ng-init="countdown()">
                <a ng-show="village_state.state == '廃村'" class="navbar-brand">
                    廃村
                </a>
                <a ng-show="village_state.state == '村民募集中'" class="navbar-brand">
                    村民募集中... 後 {{wantnum}} 人！ （{{time}}秒）
                </a>
                <a ng-show="village_state.state == 'Playing'" class="navbar-brand">
                    {{village_state.days}}日目 {{village_state.phase}} （{{time}}秒）
                </a>
            </div>
        </div>
    </nav>

    <div class="container" ng-style="style_container">
        <div ng-show="village_state.state == '廃村'">
            <br>
            <a href="/init_village">村を作ってください…</a>
        </div> 
        
        <div ng-show="village_state.state == '村民募集中'">
            <br>
            <div ng-show="user">
            {{user.name}}さんの役職は…「{{user.role}}」です！
            </div>
            <form novalidate class="form-inline" name="joinForm" ng-show="!user" ng-submit="joinVillage()" role="form">
                <div class="form-group">
                    <label for="inputName" class="control-label">お名前</label>
                    <input id="inputName" type="text" class="form-control" style="max-width:200px;" name="name" ng-model="joinname" required ng-maxlength="10">
                </div>
                <span class="msg-error" ng-show="joinForm.name.$error.maxlength">10文字まで！</span>
                <button type="submit" class="btn btn-primary">住居申請</button>
            </form>

            <hr> 
            <h4>村民一覧</h4> 
            <ul ng-repeat="v in villagers">
                <li>{{v.name}}</li>
            </ul>
            <pre>{{user|json}}</pre>
            <pre>{{village|json}}</pre>
        </div> 
        

        <div ng-show="village_state.state == 'Playing'">
            <div bs-active-pane="cmds.activeTab" bs-tabs>
                <div ng-repeat="cmd in cmds" title="{{ cmd }}" name="{{ cmd }}" bs-pane>
                </div>
            </div>
            
            <div class="cmdarea" ng-show="cmds.activeTab == '状態'">
                <div>
                {{user.name}}さんの役職は…「{{user.role}}」です！
                </div>
                <hr>
                <pre>{{village_state|json}}</pre>
            </div>
            <div class="cmdarea" ng-show="cmds.activeTab == '村会'">
                <div id="vchatbox" class="chatbox" ng-style="style_chatbox">
                    <div ng-repeat="r in villager_remarks">
                        {{r.name}}
                        <pre>{{r.msg}}</pre>
                    </div>
                </div>
                <form novalidate id="vform" name="villagerForm" ng-submit="sendVillager()" role="form">
                    <div class="input-group">
                        <input type="text" class="form-control" name="villagertext" ng-model="villagertext" required ng-maxlength="512">
                        <span class="input-group-btn">
                            <button type="submit" class="btn btn-primary">投稿</button>
                        </span>
                    </div>
                </form>
            </div>
            <div class="cmdarea" ng-show="cmds.activeTab == '狼会'">
                <div id="wchatbox" class="chatbox" ng-style="style_chatbox">
                    <div ng-repeat="r in werewolf_remarks">
                        {{r.name}}
                        <pre>{{r.msg}}</pre>
                    </div>
                </div>
                <form novalidate id="wform" name="werewolfForm" ng-submit="sendWerewolf()" role="form">
                    <div class="input-group">
                        <input type="text" class="form-control" name="werewolftext" ng-model="werewolftext" required ng-maxlength="512">
                        <span class="input-group-btn">
                            <button type="submit" class="btn btn-primary">投稿</button>
                        </span>
                    </div>
                </form>
            </div>
            <div class="cmdarea" ng-show="cmds.activeTab == '噛む'">
                <form novalidate id="biteform" name="biteForm" ng-submit="bite()" role="form">
                    <div class="input-group">
                        <select class="form-control" ng-model="bitetarget" ng-options="target for target in bitetargets"></select> 
                        <span class="input-group-btn">
                            <button type="submit" class="btn btn-primary">噛む</button>
                        </span>
                    </div>
                </form>
            </div>
            <div class="cmdarea" ng-show="cmds.activeTab == '占う'">
            </div>
            <div class="cmdarea" ng-show="cmds.activeTab == '守る'">
            </div>
            <div class="cmdarea" ng-show="cmds.activeTab == '投票'">
                <form novalidate id="voteform" name="voteForm" ng-submit="vote()" role="form">
                    <div class="input-group">
                        <select class="form-control" ng-model="votetarget" ng-options="target for target in votetargets"></select> 
                        <span class="input-group-btn">
                            <button type="submit" class="btn btn-primary">投票</button>
                        </span>
                    </div>
                </form>
            </div>
        </div>
        
        
    
    </div>

</body>
</html>
